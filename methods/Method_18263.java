private static void addCurrentAffinityGroupToTransitionMapping(LayoutState layoutState){
  final OutputUnitsAffinityGroup<LayoutOutput> group=layoutState.mCurrentLayoutOutputAffinityGroup;
  if (group == null || group.isEmpty()) {
    return;
  }
  final TransitionId transitionId=layoutState.mCurrentTransitionId;
  if (transitionId == null) {
    return;
  }
  if (transitionId.mType == TransitionId.Type.AUTOGENERATED) {
    if (!layoutState.mDuplicatedTransitionIds.contains(transitionId)) {
      if (layoutState.mTransitionIdMapping.put(transitionId,group) != null) {
        layoutState.mTransitionIdMapping.remove(transitionId);
        layoutState.mDuplicatedTransitionIds.add(transitionId);
      }
    }
  }
 else {
    if (layoutState.mTransitionIdMapping.put(transitionId,group) != null) {
      ComponentsReporter.emitMessage(ComponentsReporter.LogLevel.FATAL,"The transitionId '" + transitionId + "' is defined multiple times in the same layout. TransitionIDs must be unique.\n" + "Tree:\n" + ComponentUtils.treeToString(layoutState.mLayoutRoot));
    }
  }
  layoutState.mCurrentLayoutOutputAffinityGroup=null;
  layoutState.mCurrentTransitionId=null;
}
