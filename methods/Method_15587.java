/** 
 * ????
 * @param fun
 * @param request
 * @param function ??get(Map:map,key)???????????????
 * @return
 */
public static Object invoke(@NotNull RemoteFunction fun,@NotNull JSONObject request,@NotNull String function) throws Exception {
  FunctionBean fb=parseFunction(function,request,false);
  try {
    return invoke(fun,fb.getMethod(),fb.getTypes(),fb.getValues());
  }
 catch (  Exception e) {
    if (e instanceof NoSuchMethodException) {
      throw new IllegalArgumentException("?? " + function + " ??????? " + getFunction(fb.getMethod(),fb.getKeys()) + " ???????DemoFunction??" + "\n???????????????????????" + "\n???? function(key0,key1,...) ????????" + "\nfunction????Java?????key????request??????" + "\n?????????");
    }
    if (e instanceof InvocationTargetException) {
      Throwable te=((InvocationTargetException)e).getTargetException();
      if (StringUtil.isEmpty(te.getMessage(),true) == false) {
        throw te instanceof Exception ? (Exception)te : new Exception(te.getMessage());
      }
      throw new IllegalArgumentException("?? " + function + " ??????????????" + "\n??? key:value ?value????????????? " + getFunction(fb.getMethod(),fb.getKeys()) + " ????");
    }
    throw e;
  }
}
